<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="cheese.css">
 <style>
  .window {
   position: absolute;
   background-color: #ffffff;
   display: flex;
   flex-direction: column;
  }
  
  .windowbar {
   background-color: #777777;
   height: 20px;
   flex-shrink: 0;
  }
  
  .windowcontent {
   background-color: #dddddd;
   color: #000000;
   height: 100%;
  }
  
  .windowresizeleft {
   position: absolute;
   left: -10px;
   background-color: #555555;
   width: 10px !important;
   height: 100%;
  }
  
  .windowresizeright {
   position: absolute;
   left: 100%;
   background-color: #555555;
   width: 10px !important;
   height: 100%;
  }
  
  .windowresizetop {
   position: absolute;
   top: -10px;
   background-color: #555555;
   width: 100%;
   height: 10px !important;
  }
  
  .windowresizebottom {
   position: absolute;
   top: 100%;
   background-color: #555555;
   width: 100%;
   height: 10px !important;
  }
  
  .windowminimize {
   float: right;
   background-color: #0000ff;
   width: 20px;
   height: 20px;
  }
  
  .windowfull {
   float: right;
   background-color: #00ff00;
   width: 20px;
   height: 20px;
  }
  
  .windowclose {
   float: right;
   background-color: #ff0000;
   width: 20px;
   height: 20px;
  }
 </style>
	<title>winux</title>
</head>
<body>
  <a href="./">BACK HOME</a>
  <h1>trout</h1>
  <p>warning: it doesn't work on mobile :(</p>
</body>
<script>
  function makeDraggable(draggable, update) {
    let pmouseX, pmouseY;
    
    function startDrag(event) {
      console.log("touch started");
      event.preventDefault();
      pmouseX = event.pageX;
      pmouseY = event.pageY;
      document.addEventListener('mouseup', endDrag);
      document.addEventListener('touchup', endDrag);
      document.addEventListener('mousemove', dragUpdate);
      document.addEventListener('touchmove', dragUpdate);
    }
    
    function endDrag() {
      console.log("touch ended");
      document.removeEventListener('mouseup', endDrag);
      document.removeEventListener('touchup', endDrag);
      document.removeEventListener('mousemove', dragUpdate);
      document.removeEventListener('touchmove', dragUpdate);
    }
    
    function dragUpdate(event) {
      event.preventDefault();
      const dmouseX = pmouseX - event.pageX;
      const dmouseY = pmouseY - event.pageY;
      pmouseX = event.pageX;
      pmouseY = event.pageY;
      update(dmouseX, dmouseY);
    }
    
    draggable.addEventListener('mousedown', startDrag);
    draggable.addEventListener('touchdown', startDrag);
  }
  
  function spawnWindow({init, x = 200, y = 200, w = 200, h = 200} = {}) {
    const container = document.createElement('div');
    container.classList.add('window');
    container.style.top = y + 'px';
    container.style.left = x + 'px';
    container.style.width = w + 'px';
    container.style.height = h + 'px';
    const bar = document.createElement('div');
    bar.classList.add('windowbar');
    const close = document.createElement('div');
    close.classList.add('windowclose');
    bar.append(close);
    const full = document.createElement('div');
    full.classList.add('windowfull');
    bar.append(full);
    const minimize = document.createElement('div');
    minimize.classList.add('windowminimize');
    bar.append(minimize);
    container.append(bar);
    makeDraggable(bar, (dx, dy) => {
      container.style.top = (container.offsetTop - dy) + 'px';
      container.style.left = (container.offsetLeft - dx) + 'px';
    });
    const content = document.createElement('div');
    content.classList.add('windowcontent');
    container.append(content);
    const resizeleft = document.createElement('div');
    resizeleft.classList.add('windowresizeleft');
    container.append(resizeleft);
    makeDraggable(resizeleft, (dx, dy) => {
      container.style.left = (container.offsetLeft - dx) + 'px';
      container.style.width = Math.max(container.offsetWidth + dx, 60) + 'px';
    });
    const resizeright = document.createElement('div');
    resizeright.classList.add('windowresizeright');
    container.append(resizeright);
    makeDraggable(resizeright, (dx, dy) => {
      container.style.width = Math.max(container.offsetWidth - dx, 60) + 'px';
    });
    const resizetop = document.createElement('div');
    resizetop.classList.add('windowresizetop');
    container.append(resizetop);
    makeDraggable(resizetop, (dx, dy) => {
      container.style.top = (container.offsetTop - dy) + 'px';
      container.style.height = Math.max(container.offsetHeight + dy, 20) + 'px';
    });
    const resizebottom = document.createElement('div');
    resizebottom.classList.add('windowresizebottom');
    container.append(resizebottom);
    makeDraggable(resizebottom, (dx, dy) => {
      container.style.height = Math.max(container.offsetHeight - dy, 20) + 'px';
    });
    const resizebottomleft = document.createElement('div');
    resizebottomleft.classList.add('windowresizeleft');
    resizebottomleft.classList.add('windowresizebottom');
    container.append(resizebottomleft);
    makeDraggable(resizebottomleft, (dx, dy) => {
      container.style.height = Math.max(container.offsetHeight - dy, 20) + 'px';
      container.style.left = (container.offsetLeft - dx) + 'px';
      container.style.width = Math.max(container.offsetWidth + dx, 60) + 'px';
    });
    const resizetopright = document.createElement('div');
    resizetopright.classList.add('windowresizeright');
    resizetopright.classList.add('windowresizetop');
    container.append(resizetopright);
    makeDraggable(resizetopright, (dx, dy) => {
      container.style.top = (container.offsetTop - dy) + 'px';
      container.style.height = Math.max(container.offsetHeight + dy, 20) + 'px';
      container.style.width = Math.max(container.offsetWidth - dx, 60) + 'px';
    });
    const resizetopleft = document.createElement('div');
    resizetopleft.classList.add('windowresizetop');
    resizetopleft.classList.add('windowresizeleft');
    container.append(resizetopleft);
    makeDraggable(resizetopleft, (dx, dy) => {
      container.style.top = (container.offsetTop - dy) + 'px';
      container.style.height = Math.max(container.offsetHeight + dy, 20) + 'px';
      container.style.left = (container.offsetLeft - dx) + 'px';
      container.style.width = Math.max(container.offsetWidth + dx, 60) + 'px';
    });
    const resizebottomright = document.createElement('div');
    resizebottomright.classList.add('windowresizebottom');
    resizebottomright.classList.add('windowresizeright');
    container.append(resizebottomright);
    makeDraggable(resizebottomright, (dx, dy) => {
      container.style.height = Math.max(container.offsetHeight - dy, 20) + 'px';
      container.style.width = Math.max(container.offsetWidth - dx, 60) + 'px';
    });
    document.body.append(container);
    if (init != undefined) {
      init({root: content});
    }
  }
  
  spawnWindow();
  spawnWindow({x: 450});
  spawnWindow({y: 450, init: ({root}) => {
    root.append("textytext! (long text text) texttexttext");
  }});
</script>
</html>
